H064 P064                      B
F*
F*  ADD / UPDATE EMPLOYEES
F*
FSCREEN  CP  F     800            WORKSTN
FCORP    IC  F10241024R 2AI     1 DISK
FPRLOC   IC  F  32  32R 4AI     1 DISK
FPREARN  IC  F 640 640R 2AI     1 DISK
FPRMAST  UC  F 640 640R 8AI     1 DISK                      A
E                    CD          8  2 0
E                    F           8  2 0
E                    DED         8  7 2
E                    BAL         8  7 2
E                    QTD        18  9 2
E                    YTD        18  9 2
E                    ECD         8  2 0
E                    EF          8  2 0
E                    EDED        8  7 2
E                    EBAL        8  7 2
E                    EQTD       18  9 2
E                    EYTD       18  9 2
E                    DDES       12 19
E                    PDDESC     12 16
E                    DD          8 16
ISCREEN  AA  01   1 CS   2 C0   3 C1
I                                        4   50CO
I                                        4  110EMPNO
I                                        4   70SCO
I        AB  02   1 CS   2 C0   3 C2
I                                        4  27 NAME
I                                       28  43
I                                       44  67
I                                       68  91 ADDR1
I                                       92 115 ADDR2
I                                      116 117 STATE
I                                      118 127 ZIP
I                                      128 1300AREA
I                                      131 1370PHONE
I                                      138 148 SS
I                                      149 1520DEPT
I                                      153 153 MS
I                                      154 1540RACE
I                                      155 155 SEX
I                                      156 1610HDATE
I                                      162 1670REHIRE
I                                      168 1730BDATE
I                                      174 1790RDATE
I                                      180 1850TDATE
I                                      186 201 REAS
I                                      202 2020STATUS
I                                      203 2030PAY
I                                        4 203 ERR1
I                                      204 2104RATE
I                                      211 2192SALARY
I                                      220 236 LIC
I                                      237 237 VAL
I                                      238
I                                      242 242
I                                      243 2492FADD
I                                      250 2562SADD
I                                      257 2632CADD
I                                      264 2650FEXP
I                                      266 2670SEXP
I                                      267 2690CEXP
I                                      270 2700MEALS
I                                      271 2710TIPS
I                                      272 273 SCD
I                                      274 2750CCD
I                                      276 284
I                                      285 301
I                                      302 302
I                                      303 303
I                                      304
I                                      313 329
I                                      330 330
I                                      331 331
I                                      204 331
I        AB  03   1 CS   2 C0   3 C3
I                                        4  19 CD
I                                       20  35 F
I                                       36  91 DED
I                                       92 147 BAL
I                                      148
I                                      153
I                                      162
I                                      171
I                                      180
I                                      189
I                                      198
I                                      207 208
I                                      209 210
I                                      148 210
I        AB  04   1 CS   2 C0   3 C4
I                                        4 165 QTD
I                                      166 1680QWK
I                                      169 330 YTD
I                                      331 3330YWK
I        AD  08
IPRMAST  NS
I                                        1   20ECO
I                                        3   80ENUM
I                                        3   80STORE
I                                        9  120EDEPT
I                                       13  36 ENAME
I                                       37  60 EADDR1
I                                       61  84 EADDR2
I                                       85  86 ESTATE
I                                       87  96 EZIP
I                                    P  97  980EAREA
I                                    P  99 1020EPHONE
I                                      103 113 ESS
I                                      114 114 EMS
I                                      115 1150ERACE
I                                      116 116 ESEX
I                                      117 1220EHDATE
I                                      123 1280ETDATE
I                                      129 144 EREAS
I                                      145 1500EBDATE
I                                      151 1560ERDATE
I                                      157 1570ESTAT
I                                      158 1580EPAY
I                                    P 159 1624ERATE
I                                    P 163 1672ESAL
I                                    P 168 1712EFADD
I                                    P 172 1752ESADD
I                                    P 176 1792ECADD
I                                      180 1810EFEXP
I                                      182 1830ESEXP
I                                      184 1850ECEXP
I                                      186 187 ESCD
I                                      188 1890ECCD
I                                      190 1900EMEALS
I                                      191 1910ETIPS
I                                      192 207 ECD
I                                      208 223 EF
I                                    P 224 255 EDED
I                                    P 256 287 EBAL
I                                    P 288 377 EQTD
I                                    P 378 3790EQWK
I                                    P 380 469 EYTD
I                                    P 470 4710EYWK
I                                    P 472
I                                    P 475
I                                    P 480
I                                    P 485
I                                    P 490
I                                    P 495
I                                    P 500
I                                      505 506 EINS1
I                                      507 508 EINS2
I                                      513
I                                      522 538
I                                      539 539
I                                      540 540
I                                      541
I                                      550 566
I                                      567 567
I                                      568 568
I                                      569 584
I                                      585 608
I                                      610 626
I                                      627 627
I                                      628
I                                      632 632
I                                      633
IPREARN  AA
I                                      243 434 PDDESC
ICORP    AA
I                                        3  42 CONAME
IPRLOC   AA
I                                        5  28 SDESC
I           UDS
I                                        1   1 FNAME
I                                        4  11 USER
I                                       12  14 BLANK
I                                       15  16 WSID
I                                        4  16 HEADER
I                                       17  200TIMEX
I                                       21  260DDATE
I                                       50
I                                       50
I                                       50
I                                      101 150 HDR1
I                                      151 200 HDR2
C   KG                GOTO END                          E.O.J.
C*
C   KC                SETON                     U3
C   KC                GOTO END
C                     SETOF                     503031
C                     SETOF                     606162
C                     SETOF                     636465
C                     SETOF                     666733
C*
C*  KA - RETRY    04 - START UP SCREEN
C*
C*
C*
C   U3                SETON                     01
C   U3                SETOF
C   08
COR KA                EXSR START
C   08
COR KA                GOTO END
C*
C   01                EXSR CHECK
C   02                EXSR CHECK2
C   03                EXSR CHECK3
C   04N50             EXSR WRITE
C*
C           END       TAG
C*
CSR         START     BEGSR
CSR                   SETON                     21
CSR                   EXCPT
CSR                   SETOF                     21
CSR                   SETON                     51
CSR                   ENDSR
C*
CSR         CHECK     BEGSR
CSR                   SETOF
C*
CSR         SCO       COMP 0                        50
CSRN50      SCO       CHAINPRLOC                50
CSR 50                SETON                     21
CSRN50      EMPNO     CHAINPRMAST               18
CSRN18N50             SETON                     19
CSRN50                SETON                     18
CSRN50      CO        CHAINCORP                 11
CSRN50                EXSR RDED
CSRN50 19             MOVE ECD       CD
CSRN50 19             EXSR MDED
C*
CSR                   EXCPT
CSR                   SETOF                     18  21
C*
CSR         ENDCK     ENDSR
C***********CHECK SCREEN 2
CSR         CHECK2    BEGSR
CSR         NAME      COMP ' '                      30
CSRN30      FIRST     COMP ' '                      30
CSRN30      LAST      COMP ' '                      30
CSR         MS        COMP 'M'                  3131
CSR 31      MS        COMP 'S'                  3131
CSR         SS        COMP ' '                      33
CSR 30
COR 33
COR 31                SETON                     50
CSR 50 02             SETON                     18
CSRN50 02             SETON                     16
CSR                   EXCPT
CSR                   SETOF                     1816
CSR                   ENDSR
C***********CHECK SCREEN 3
CSR         CHECK3    BEGSR
CSR                   MOVE *BLANKS   DD
CSR                   EXSR MDED
CSR         CD,1      COMP 0                    60
CSR 60      CD,1      COMP 12                   60
CSR         CD,2      COMP 0                    6161
CSR 61      CD,2      COMP 12                   61
CSR         CD,3      COMP 0                    6262
CSR 62      CD,3      COMP 12                   62
CSR         CD,4      COMP 0                    6363
CSR 63      CD,4      COMP 12                   63
CSR         CD,5      COMP 0                    6464
CSR 64      CD,5      COMP 12                   64
CSR         CD,6      COMP 0                    65
CSR 65      CD,6      COMP 12                   65
CSR         CD,7      COMP 0                    66
CSR 66      CD,7      COMP 12                   66
CSR         CD,8      COMP 0                    67
CSR 67      CD,8      COMP 12                   67
CSR 60
COR 61
COR 62
COR 63
COR 64
COR 65                SETON                     50
CSR 66
COR 67                SETON                     50
CSR 50 03             SETON                     16
CSRN50 03             SETON                     14
CSR                   EXCPT
CSR                   SETOF                     141516
CSR                   ENDSR
C********** WRITE RECORDS **************
CSR         WRITE     BEGSR                            NEW RECORD
CSR         EMPNO     CHAINPRMAST               24
CSRN24                SETON                     25
CSR                   EXCPT
CSR                   SETOF                     2425
CSR                   EXSR START
CSR                   ENDSR
C*
C***********READ IN DEDUCTION CODES
CSR         RDED      BEGSR
CSR         CO        CHAINPREARN               11
CSR                   MOVE PDDESC    DDES
CSR                   Z-ADD1         X       20
CSR         LOOP      TAG
CSR                   MOVELX         DDES,X
CSR         X         COMP 12                       11
CSRN11                ADD  1         X
CSRN11                GOTO LOOP
CSR                   ENDSR
C***********GET DEDUCTIONS ********
CSR         MDED      BEGSR
CSR                   MOVE *BLANKS   DD
CSR                   Z-ADD1         X
CSR         MLOOP     TAG
CSR         CD,X      COMP 0                        11
CSRN11      CD,X      COMP 12                   11
CSRN11                Z-ADDCD,X      X1      20
CSRN11                MOVE DDES,X1   DD,X
CSR         X         COMP 8                        11
CSRN11                ADD  1         X
CSRN11                GOTO MLOOP
CSR                   ENDSR
C*
OPRMAST  EADD     24
O                         EMPNO      8
O                         DEPT      12
O                         NAME      36
O                         ADDR1     60
O                         ADDR2     84
O                         STATE     86
O                         ZIP       96
O                         AREA      98P
O                         PHONE    102P
O                         SS       113
O                         MS       114
O                         RACE     115
O                         SEX      116
O                         HDATE    122
O                         TDATE    128
O                         REAS     144
O                         BDATE    150
O                         RDATE    156
O                         STATUS   157
O                         PAY      158
O                         RATE     162P
O                         SALARY   167P
O                         FADD     171P
O                         SADD     175P
O                         CADD     179P
O                         FEXP     181
O                         SEXP     183
O                         CEXP     185
O                         SCD      187
O                         CCD      189
O                         MEALS    190
O                         TIPS     191
O                         CD       207
O                         F        223
O                         DED      255P
O                         BAL      287P
O                         QTD      377P
O                         QWK      379P
O                         YTD      469P
O                         YWK      471P
O                         P401
O                         EM401
O                         EY401
O                         ERM401
O                         ERY401
O                         MWAGE
O                         M401WG
O                         INS1     506
O                         INS2     508
O                         ACCT1    538
O                         BTYP1    539
O                         DIR1     540
O                         BANK2    549
O                         ACCT2    566
O                         BTYP2    567
O                         DIR2     568
O                         FIRST    584
O                         LAST     608
O                         LIC      626
O                         VAL      627
O                         EXDATE   631
O                         ENDORS   632
O                         REHIRE   638
O        E        25
O                         EMPNO      8
O                         DEPT      12
O                         NAME      36
O                         ADDR1     60
O                         ADDR2     84
O                         STATE     86
O                         ZIP       96
O                         AREA      98P
O                         PHONE    102P
O                         SS       113
O                         MS       114
O                         RACE     115
O                         SEX      116
O                         HDATE    122
O                         TDATE    128
O                         REAS     144
O                         BDATE    150
O                         RDATE    156
O                         STATUS   157
O                         PAY      158
O                         RATE     162P
O                         SALARY   167P
O                         FADD     171P
O                         SADD     175P
O                         CADD     179P
O                         FEXP     181
O                         SEXP     183
O                         CEXP     185
O                         SCD      187
O                         CCD      189
O                         MEALS    190
O                         TIPS     191
O                         CD       207
O                         F        223
O                         DED      255P
O                         BAL      287P
O                         QTD      377P
O                         QWK      379P
O                         YTD      469P
O                         YWK      471P
O                         P401
O                         EM401
O                         EY401
O                         ERM401
O                         ERY401
O                         MWAGE
O                         M401WG
O                         INS1     506
O                         INS2     508
O                         BANK1    521
O                         ACCT1    538
O                         BTYP1    539
O                         DIR1     540
O                         BANK2    549
O                         ACCT2    566
O                         BTYP2    567
O                         DIR2     568
O                         FIRST    584
O                         LAST     608
O                         LIC      626
O                         VAL      627
O                         EXDATE   631
O                         ENDORS   632
O                         REHIRE   638
O*
O*  AVOID SECTOR LOCKOUT
O*
O        E        19
